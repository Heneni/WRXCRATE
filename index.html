<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>cratedigger.js</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <link rel="stylesheet" href="cratedigger.css" />
  <link rel="stylesheet" href="main.css" />
  <!-- Link the custom favicon instead of relying on the default favicon.ico request -->
  <link rel="icon" href="favicon_Version7.ico" type="image/x-icon" />
  <!-- Use HTTPS to avoid mixed‑content errors on GitHub Pages -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
</head>
<body>
  <div id="cratedigger">
    <div id="cratedigger-canvas"></div>
    <div id="cratedigger-loading">
      <div class="info-container">
        <div class="vertical-center">
          <span class="loading-label">Loading records...</span>
        </div>
      </div>
    </div>
    <div id="cratedigger-info">
      <div class="info-container">
        <div class="vertical-center">
          <div id="cratedigger-record-artist"></div>
          <div id="cratedigger-record-title"></div>
          <div id="cratedigger-record-cover"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="bottom-bar" class="noselect">
    <div id="button-prev" class="bottom-bar-item">PREVIOUS</div>
    <div id="button-show" class="bottom-bar-item">SHOW</div>
    <div id="button-next" class="bottom-bar-item">NEXT</div>
  </div>

  <!-- Existing vendor scripts -->
  <script src="bower_components/modernizr/modernizr.js"></script>
  <script src="bower_components/threejs/build/three.min.js"></script>
  <script src="bower_components/dat-gui/build/dat.gui.min.js"></script>

  <script src="cratedigger.js"></script>

<!-- Make constants.js usable from classic scripts -->
<script>
  // Lightweight ES module loader shim for a single default export
  (function attachConstants(){
    var s = document.createElement('script');
    s.type = 'module';
    s.text = `
      import cfg from './constants.js';
      window.CRATE_CFG = cfg;
    `;
    document.currentScript.after(s);
  })();
</script>

<script>
  // Wait until constants are attached, then boot your app
  (function bootWhenReady(){
    function ready(){ return window.CRATE_CFG && window.cratedigger; }
    function tick(){
      if(ready()){
        // If your main.js exposes a global boot, call it here; otherwise
        // main.js will read window.CRATE_CFG directly.
        if (window.bootCrateDigger) window.bootCrateDigger(window.CRATE_CFG);
        return;
      }
      setTimeout(tick, 0);
    }
    tick();
  })();
</script>

<!-- index.html — bottom of <body>; ensure this exact order -->
<script src="cratedigger.js"></script>
<script src="main.js"></script>
